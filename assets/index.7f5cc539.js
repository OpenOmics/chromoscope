var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,o=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&r(e,a,t[a]);if(i)for(var a of i(t))l.call(t,a)&&r(e,a,t[a]);return e};import{r as s,l as d,R as c,g as m,a as g}from"./vendor.5d538dfc.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var p={color:{svclass:{domain:["DUP","TRA","DEL","t2tlNV","h2hlNV"],range:["#569C4D","#4C75A2","#DA5456","#EA8A2A","#ECC949"]}}};function u(e){const{cnvUrl:t,svUrl:a,width:i,showPutativeDriver:n,showOverview:l,xOffset:r}=e;return l?[{xOffset:r,layout:"circular",spacing:1,style:{outlineWidth:1,outline:"lightgray"},tracks:[{id:"top-view",title:"Ideogram",alignment:"overlay",data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/UCSC.HG38.Human.CytoBandIdeogram.csv",type:"csv",chromosomeField:"Chromosome",genomicFields:["chromStart","chromEnd"]},tracks:[{mark:"rect"},{mark:"brush",x:{linkingId:"mid-scale"},strokeWidth:{value:1.5},stroke:{value:"#0070DC"},color:{value:"#AFD8FF"},opacity:{value:.5}}],color:{field:"Stain",type:"nominal",domain:["gneg","gpos25","gpos50","gpos75","gpos100","gvar","acen"],range:["white","lightgray","gray","gray","black","#7B9CC8","#DC4542"]},size:{value:18},x:{field:"chromStart",type:"genomic"},xe:{field:"chromEnd",type:"genomic"},stroke:{value:"gray"},strokeWidth:{value:.3},width:i,height:100},...n?[{title:"Putative Driver",alignment:"overlay",data:{url:"https://s3.amazonaws.com/gosling-lang.org/data/SV/driver.df.scanb.complete.csv",type:"csv",chromosomeField:"Chr",genomicFields:["ChrStart","ChrEnd"]},dataTransform:[{type:"filter",field:"Sample",oneOf:["PD35930a"]}],tracks:[{mark:"text"},{mark:"triangleBottom",size:{value:5}}],x:{field:"ChrStart",type:"genomic"},xe:{field:"ChrEnd",type:"genomic"},text:{field:"Gene",type:"nominal"},color:{value:"black"},style:{textFontWeight:"normal",dx:-10,outlineWidth:0},width:i,height:40}]:[],{title:"Gain",style:{background:"lightgray",backgroundOpacity:.2},alignment:"overlay",data:{separator:"\t",url:t,type:"csv",chromosomeField:"chromosome",genomicFields:["start","end"],quantitativeFields:["total_cn"]},dataTransform:[{type:"filter",field:"total_cn",inRange:[4.9999,999999999]}],tracks:[{mark:"rect"},{mark:"brush",x:{linkingId:"mid-scale"},strokeWidth:{value:0}}],x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},color:{value:"#73C475"},width:i,height:40},{title:"LOH",style:{background:"lightgray",backgroundOpacity:.2},alignment:"overlay",data:{separator:"\t",url:t,type:"csv",chromosomeField:"chromosome",genomicFields:["start","end"]},dataTransform:[{type:"filter",field:"minor_cn",oneOf:["0"]}],tracks:[{mark:"rect"},{mark:"brush",x:{linkingId:"mid-scale"},strokeWidth:{value:1},stroke:{value:"#94C2EF"},color:{value:"#AFD8FF"}}],x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},color:{value:"#FB6A4B"},width:i,height:40},{title:"Structural Variant",data:{url:a,type:"csv",separator:"\t",genomicFieldsToConvert:[{chromosomeField:"chrom1",genomicFields:["start1","end1"]},{chromosomeField:"chrom2",genomicFields:["start2","end2"]}]},mark:"withinLink",x:{field:"start1",type:"genomic"},xe:{field:"end2",type:"genomic"},color:{field:"svclass",type:"nominal",legend:!0,domain:p.color.svclass.domain,range:p.color.svclass.range},stroke:{field:"svclass",type:"nominal",domain:p.color.svclass.domain,range:p.color.svclass.range},strokeWidth:{value:1},opacity:{value:.6},style:{legendTitle:"SV Class"},width:i,height:80}]}]:[]}var h={"gosling.js":"^0.9.4",lodash:"^4.17.21","pixi.js":"^6.0.4",react:"^17.0.0","react-dom":"^17.0.0"};const f=window.innerWidth,v=["chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY"];function y(){const e=s.exports.useRef(),[i,n]=s.exports.useState("https://s3.amazonaws.com/gosling-lang.org/data/SV/84ca6ab0-9edc-4636-9d27-55cdba334d7d.pcawg_consensus_1.6.161022.somatic.sv.bedpe"),[l,r]=s.exports.useState("https://s3.amazonaws.com/gosling-lang.org/data/SV/84ca6ab0-9edc-4636-9d27-55cdba334d7d.consensus.20170119.somatic.cna.annotated.txt"),[g,y]=s.exports.useState(!0),[b,x]=s.exports.useState(!0),[k,w]=s.exports.useState(f-400-120),[F,E]=s.exports.useState(""),[C,S]=s.exports.useState(""),[N,T]=s.exports.useState(!1);s.exports.useEffect((()=>{if(e.current)return e.current.api.subscribe("click",((t,a)=>{e.current.api.zoomTo("bam-1",`chr1:${a.data.start1}-${a.data.end1}`,2e3,100),e.current.api.zoomTo("bam-2",`chr1:${a.data.start2}-${a.data.end2}`,2e3,100)})),()=>{e.current.api.unsubscribe("click")}}),[e]),s.exports.useEffect((()=>{var t,a;F&&(F.includes("chr")?(null==(t=e.current)||t.api.zoomTo("top-view",F,0,100),S(F)):null==(a=e.current)||a.api.zoomToExtent("top-view",100))}),[F]),s.exports.useEffect((()=>{var t,a;C&&(C.includes("chr")?null==(t=e.current)||t.api.zoomTo("mid-view",C,0,100):null==(a=e.current)||a.api.zoomToExtent("mid-view",100))}),[C]),s.exports.useEffect((()=>{window.addEventListener("resize",d.exports.debounce((()=>{w(window.innerWidth-400-120)}),500))}),[]);const O=s.exports.useMemo((()=>{const n=JSON.parse(JSON.stringify(function(e){const{svUrl:i,cnvUrl:n,showPutativeDriver:l,showOverview:r,width:s}=e,d=Math.min(s,600),c=s,m=s/2-10,g=(s-d)/2;return{layout:"linear",arrangement:"vertical",centerRadius:.5,assembly:"hg19",spacing:40,style:{outlineWidth:1,outline:"lightgray",enableSmoothPath:!1},views:[{arrangement:"vertical",views:[...u((h=o({},e),f={width:d,xOffset:g},t(h,a(f)))),{linkingId:"mid-scale",xDomain:{chromosome:"1"},layout:"linear",tracks:[{id:"mid-view",style:{background:"#D7EBFF",outline:"#8DC1F2",outlineWidth:5},title:"Ideogram",alignment:"overlay",data:{url:"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/UCSC.HG38.Human.CytoBandIdeogram.csv",type:"csv",chromosomeField:"Chromosome",genomicFields:["chromStart","chromEnd"]},tracks:[{mark:"rect",dataTransform:[{type:"filter",field:"Stain",oneOf:["acen"],not:!0}]},{mark:"triangleRight",dataTransform:[{type:"filter",field:"Stain",oneOf:["acen"]},{type:"filter",field:"Name",include:"q"}]},{mark:"triangleLeft",dataTransform:[{type:"filter",field:"Stain",oneOf:["acen"]},{type:"filter",field:"Name",include:"p"}]},{mark:"text",dataTransform:[{type:"filter",field:"Stain",oneOf:["acen"],not:!0}],size:{value:12},color:{field:"Stain",type:"nominal",domain:["gneg","gpos25","gpos50","gpos75","gpos100","gvar"],range:["black","black","black","black","white","black"]},visibility:[{operation:"less-than",measure:"width",threshold:"|xe-x|",transitionPadding:10,target:"mark"}]}],color:{field:"Stain",type:"nominal",domain:["gneg","gpos25","gpos50","gpos75","gpos100","gvar","acen"],range:["white","lightgray","gray","gray","black","#7B9CC8","#DC4542"]},size:{value:18},x:{field:"chromStart",type:"genomic"},xe:{field:"chromEnd",type:"genomic"},text:{field:"Name",type:"nominal"},stroke:{value:"gray"},strokeWidth:{value:.3},width:c,height:30},...l?[{title:"Putative Driver",data:{url:"https://s3.amazonaws.com/gosling-lang.org/data/SV/driver.df.scanb.complete.csv",type:"csv",chromosomeField:"Chr",genomicFields:["ChrStart","ChrEnd"]},dataTransform:[{type:"filter",field:"Sample",oneOf:["PD35930a"]}],mark:"text",x:{field:"ChrStart",type:"genomic"},xe:{field:"ChrEnd",type:"genomic"},text:{field:"Gene",type:"nominal"},color:{value:"black"},style:{textFontWeight:"normal",dx:-10},width:c,height:20}]:[],{alignment:"overlay",title:"hg38 | Genes",template:"gene",data:{url:"https://server.gosling-lang.org/api/v1/tileset_info/?d=gene-annotation",type:"beddb",genomicFields:[{index:1,name:"start"},{index:2,name:"end"}],valueFields:[{index:5,name:"strand",type:"nominal"},{index:3,name:"name",type:"nominal"}],exonIntervalFields:[{index:12,name:"start"},{index:13,name:"end"}]},encoding:{startPosition:{field:"start"},endPosition:{field:"end"},strandColor:{field:"strand",range:["gray"]},strandRow:{field:"strand"},opacity:{value:.4},geneHeight:{value:20},geneLabel:{field:"name"},geneLabelFontSize:{value:20},geneLabelColor:{field:"strand",range:["gray"]},geneLabelStroke:{value:"white"},geneLabelStrokeThickness:{value:4},geneLabelOpacity:{value:1},type:{field:"type"}},width:c,height:60},{title:"Gain",style:{background:"lightgray",backgroundOpacity:.2},data:{separator:"\t",url:n,type:"csv",chromosomeField:"chromosome",genomicFields:["start","end"]},dataTransform:[{type:"filter",field:"aceseq_copy_number",inRange:[4.5,900]}],mark:"rect",x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},color:{value:"#73C475"},width:c,height:20},{title:"LOH",style:{background:"lightgray",backgroundOpacity:.2},data:{separator:"\t",url:n,type:"csv",chromosomeField:"chromosome",genomicFields:["start","end"]},dataTransform:[{type:"filter",field:"minor_cn",oneOf:["0"]}],mark:"rect",x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},color:{value:"#FB6A4B"},width:c,height:20},{title:"Structural Variant",data:{url:i,type:"csv",separator:"\t",genomicFieldsToConvert:[{chromosomeField:"chrom1",genomicFields:["start1","end1"]},{chromosomeField:"chrom2",genomicFields:["start2","end2"]}]},alignment:"overlay",tracks:[{mark:"withinLink",x:{field:"start1",type:"genomic"},xe:{field:"end2",type:"genomic"}},{mark:"brush",x:{linkingId:"detail-scale-1"},color:{value:"black"},stroke:{value:"black"},strokeWidth:{value:2},opacity:{value:.3}},{mark:"brush",x:{linkingId:"detail-scale-2"},color:{value:"black"},stroke:{value:"black"},strokeWidth:{value:2},opacity:{value:.3}}],color:{field:"svclass",type:"nominal",legend:!0,domain:p.color.svclass.domain,range:p.color.svclass.range},stroke:{field:"svclass",type:"nominal",domain:p.color.svclass.domain,range:p.color.svclass.range},strokeWidth:{value:1},opacity:{value:.6},size:{value:4},tooltip:[{field:"start1",type:"genomic"},{field:"end2",type:"genomic"},{field:"svclass",type:"nominal"}],style:{legendTitle:"SV Class",bazierLink:!0},width:c,height:200}]}]},{arrangement:"horizontal",spacing:20,views:[{static:!1,layout:"linear",centerRadius:.05,xDomain:{chromosome:"1",interval:[205e3,207e3]},spacing:.01,linkingId:"detail-scale-1",tracks:[{id:"bam-1",title:"Coverage",data:{type:"bam",url:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam",indexUrl:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam.bai"},dataTransform:[{type:"coverage",startField:"from",endField:"to"}],mark:"bar",x:{field:"from",type:"genomic"},xe:{field:"to",type:"genomic"},y:{field:"coverage",type:"quantitative",axis:"right",grid:!0},color:{value:"lightgray"},stroke:{value:"gray"},width:m,height:80},{alignment:"overlay",title:"hg38 | Genes",template:"gene",data:{url:"https://server.gosling-lang.org/api/v1/tileset_info/?d=gene-annotation",type:"beddb",genomicFields:[{index:1,name:"start"},{index:2,name:"end"}],valueFields:[{index:5,name:"strand",type:"nominal"},{index:3,name:"name",type:"nominal"}],exonIntervalFields:[{index:12,name:"start"},{index:13,name:"end"}]},encoding:{startPosition:{field:"start"},endPosition:{field:"end"},strandColor:{field:"strand",range:["gray"]},strandRow:{field:"strand"},opacity:{value:.4},geneHeight:{value:20},geneLabel:{field:"name"},geneLabelFontSize:{value:20},geneLabelColor:{field:"strand",range:["gray"]},geneLabelStroke:{value:"white"},geneLabelStrokeThickness:{value:4},geneLabelOpacity:{value:1},type:{field:"type"}},width:m,height:60},{title:"Sequence",alignment:"overlay",data:{url:"https://server.gosling-lang.org/api/v1/tileset_info/?d=sequence-multivec",type:"multivec",row:"base",column:"position",value:"count",categories:["A","T","G","C"],start:"start",end:"end"},tracks:[{mark:"bar",y:{field:"count",type:"quantitative",axis:"none"}},{dataTransform:[{type:"filter",field:"count",oneOf:[0],not:!0}],mark:"text",x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},size:{value:24},color:{value:"white"},visibility:[{operation:"less-than",measure:"width",threshold:"|xe-x|",transitionPadding:30,target:"mark"},{operation:"LT",measure:"zoomLevel",threshold:10,target:"track"}]}],x:{field:"position",type:"genomic"},color:{field:"base",type:"nominal",domain:["A","T","G","C"],legend:!0},text:{field:"base",type:"nominal"},style:{inlineLegend:!0},width:m,height:40},{alignment:"overlay",title:"Reads",data:{type:"bam",url:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam",indexUrl:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam.bai"},mark:"rect",tracks:[{dataTransform:[{type:"displace",method:"pile",boundingBox:{startField:"from",endField:"to",padding:5,isPaddingBP:!0},newField:"pileup-row"}],x:{field:"from",type:"genomic"},xe:{field:"to",type:"genomic"},stroke:{value:"white"},strokeWidth:{value:.5}},{dataTransform:[{type:"displace",method:"pile",boundingBox:{startField:"from",endField:"to",padding:5,isPaddingBP:!0},newField:"pileup-row"},{type:"subjson",field:"substitutions",genomicField:"pos",baseGenomicField:"from",genomicLengthField:"length"},{type:"filter",field:"type",oneOf:["sub"]}],x:{field:"pos_start",type:"genomic"},xe:{field:"pos_end",type:"genomic"},color:{field:"variant",type:"nominal",domain:["A","T","G","C","S","H","X","I","D"],legend:!0}}],y:{field:"pileup-row",type:"nominal",flip:!1},color:{value:"#97A8B2"},style:{outlineWidth:.5},width:m,height:310}]},{static:!1,layout:"linear",centerRadius:.05,xDomain:{chromosome:"1",interval:[49e4,496e3]},spacing:.01,linkingId:"detail-scale-2",tracks:[{id:"bam-2",title:"Coverage",data:{type:"bam",url:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam",indexUrl:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam.bai"},dataTransform:[{type:"coverage",startField:"from",endField:"to"}],mark:"bar",x:{field:"from",type:"genomic"},xe:{field:"to",type:"genomic"},y:{field:"coverage",type:"quantitative",axis:"right",grid:!0},color:{value:"lightgray"},stroke:{value:"gray"},width:m,height:80},{alignment:"overlay",title:"hg38 | Genes",template:"gene",data:{url:"https://server.gosling-lang.org/api/v1/tileset_info/?d=gene-annotation",type:"beddb",genomicFields:[{index:1,name:"start"},{index:2,name:"end"}],valueFields:[{index:5,name:"strand",type:"nominal"},{index:3,name:"name",type:"nominal"}],exonIntervalFields:[{index:12,name:"start"},{index:13,name:"end"}]},encoding:{startPosition:{field:"start"},endPosition:{field:"end"},strandColor:{field:"strand",range:["gray"]},strandRow:{field:"strand"},opacity:{value:.4},geneHeight:{value:20},geneLabel:{field:"name"},geneLabelFontSize:{value:20},geneLabelColor:{field:"strand",range:["gray"]},geneLabelStroke:{value:"white"},geneLabelStrokeThickness:{value:4},geneLabelOpacity:{value:1},type:{field:"type"}},width:m,height:60},{title:"Sequence",alignment:"overlay",data:{url:"https://server.gosling-lang.org/api/v1/tileset_info/?d=sequence-multivec",type:"multivec",row:"base",column:"position",value:"count",categories:["A","T","G","C"],start:"start",end:"end"},tracks:[{mark:"bar",y:{field:"count",type:"quantitative",axis:"none"}},{dataTransform:[{type:"filter",field:"count",oneOf:[0],not:!0}],mark:"text",x:{field:"start",type:"genomic"},xe:{field:"end",type:"genomic"},size:{value:24},color:{value:"white"},visibility:[{operation:"less-than",measure:"width",threshold:"|xe-x|",transitionPadding:30,target:"mark"},{operation:"LT",measure:"zoomLevel",threshold:10,target:"track"}]}],x:{field:"position",type:"genomic"},color:{field:"base",type:"nominal",domain:["A","T","G","C"],legend:!0},text:{field:"base",type:"nominal"},style:{inlineLegend:!0},width:m,height:40},{alignment:"overlay",title:"Reads",data:{type:"bam",url:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam",indexUrl:"https://aveit.s3.amazonaws.com/higlass/bam/example_higlass.bam.bai"},mark:"rect",tracks:[{dataTransform:[{type:"displace",method:"pile",boundingBox:{startField:"from",endField:"to",padding:5,isPaddingBP:!0},newField:"pileup-row"}],x:{field:"from",type:"genomic"},xe:{field:"to",type:"genomic"},stroke:{value:"white"},strokeWidth:{value:.5}},{dataTransform:[{type:"displace",method:"pile",boundingBox:{startField:"from",endField:"to",padding:5,isPaddingBP:!0},newField:"pileup-row"},{type:"subjson",field:"substitutions",genomicField:"pos",baseGenomicField:"from",genomicLengthField:"length"},{type:"filter",field:"type",oneOf:["sub"]}],x:{field:"pos_start",type:"genomic"},xe:{field:"pos_end",type:"genomic"},color:{field:"variant",type:"nominal",domain:["A","T","G","C","S","H","X","I","D"],legend:!0}}],y:{field:"pileup-row",type:"nominal",flip:!1},color:{value:"#97A8B2"},width:m,height:310}]}]}]};var h,f}({svUrl:i,cnvUrl:l,showOverview:g,xOffset:0,showPutativeDriver:b,width:k})));return c.createElement(m.exports.GoslingComponent,{ref:e,spec:n,padding:0,margin:0})}),[k,g,b,i,l]);return c.createElement(c.Fragment,null,c.createElement("div",{className:"config-panel",style:{width:360}},c.createElement("div",{className:"config-panel-section-title"},"Data"),c.createElement("div",{className:"config-panel-input-container"},c.createElement("span",{className:"config-panel-label"},"SV",c.createElement("small",null)),c.createElement("span",{className:"config-panel-input"},c.createElement("input",{className:"config-panel-search-box",type:"text",value:i,disabled:!0}))),c.createElement("div",{className:"config-panel-input-container"},c.createElement("span",{className:"config-panel-label"},"CNV",c.createElement("small",null)),c.createElement("span",{className:"config-panel-input"},c.createElement("input",{className:"config-panel-search-box",type:"text",value:l,disabled:!0}))),c.createElement("div",{className:"config-panel-section-title"},"Navigation"),c.createElement("div",{className:"config-panel-input-container"},c.createElement("span",{className:"config-panel-label"},"Circular Overview"),c.createElement("span",{className:"config-panel-input"},c.createElement("select",{className:"config-panel-dropdown",onChange:e=>E(e.currentTarget.value),value:F,disabled:!g},["All",...v].map((e=>c.createElement("option",{key:e,value:e},e)))))),c.createElement("div",{className:"config-panel-input-container"},c.createElement("span",{className:"config-panel-label"},"Linear Genome View"),c.createElement("span",{className:"config-panel-input"},c.createElement("select",{className:"config-panel-dropdown",onChange:e=>S(e.currentTarget.value),value:C},v.map((e=>c.createElement("option",{key:e,value:e},e)))))),c.createElement("div",{className:"config-panel-section-title"},"Visibility"),c.createElement("div",{className:"config-panel-input-container"},c.createElement("span",{className:"config-panel-label"},"Circular Overview"),c.createElement("span",{className:"config-panel-input"},c.createElement("input",{type:"checkbox",checked:g,onChange:()=>{y(!g)}}))),c.createElement("div",{className:"config-panel-input-container"},c.createElement("span",{className:"config-panel-label"},"Putative Driver Track"),c.createElement("span",{className:"config-panel-input"},c.createElement("input",{type:"checkbox",checked:b,onChange:()=>{x(!b)}}))),c.createElement("div",{className:"config-panel-section-title"},"Export"),c.createElement("div",{className:"config-panel-button",onClick:()=>{var t;return null==(t=e.current)?void 0:t.api.exportPng()}},"PNG")),c.createElement("div",{className:"vis-panel",style:{height:"calc(100% - 120px)",padding:60},onClick:()=>T(!1)},O,c.createElement("div",{className:"vis-panel-title panel-title"},c.createElement("small",null,"v",h["gosling.js"]))))}g.render(c.createElement(y,null),document.getElementById("root"));
